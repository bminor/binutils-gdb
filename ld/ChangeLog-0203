2003-12-19  Kazuhiro Inaoka  <inaoka.kazuhiro@renesas.com>

	Add m32r-linux and PIC support.  Add new ABI that uses RELA.
	* Makefile.am: Added em32rlelf.c, em32relf_linux.c,
	em32rlelf_linux.c.
	* Makefile.in: Regenerate.
	* configure.tgt (m32r*-*-linux*, m32r*le-*-linux*, m32r*le-*-*):Added.
	* emulparams/m32relf_linux.sh: Added.
	* emulparams/m32rlelf.sh: Ditto.
	* emulparams/m32rlelf_linux.sh: Ditto.
	* NEWS: Mention support m32r Linux.

2003-12-18  Eric Youngdale  <eric@mkssoftware.com>
            Nick Clifton  <nickc@redhat.com>

	* emultempl/pe.em (_after_open): When scanning MS import
	libraries allow for the possible presence of static objects.
          
2003-12-07  H.J. Lu  <hongjiu.lu@intel.com>

	* ldlang.c (lang_vers_match): Pass "DMGL_PARAMS | DMGL_ANSI" to
	cplus_demangle.

2003-12-07  Kazu Hirata  <kazu@cs.umass.edu>

	* ldemul.c: Convert to ISO-C.
	* ldver.c: Likewise.

2003-12-06  Kazu Hirata  <kazu@cs.umass.edu>

	* lexsup.c (is_num): Remove.

2003-12-05  Dmitry Semyonov  <Dmitry.Semyonov@oktet.ru>

	* pe-dll.c (generate_reloc): Remap ARM_26D relocation from 5 to
	0.  This fixes "bad fixup" error generated by MS linker.

2003-12-04  H.J. Lu  <hongjiu.lu@intel.com>

	* emultempl/ia64elf.em (gld${EMULATION_NAME}_after_parse): Set
	link_info.need_relax_finalize to TRUE.

	* ldlang.c (lang_process): Use link_info.need_relax_finalize
	instead of link_info.relax_finalizing.
	* ldmain.c (main): Likewise.
	
2003-12-04  Dmitry Semyonov  <Dmitry.Semyonov@oktet.ru>

	* armpe.sh (RELOCATEABLE_OUTPUT_FORMAT): Define.

2003-12-04  Alan Modra  <amodra@bigpond.net.au>

	* ldlang.c (lang_do_assignments): Function return is void.
	* ldlang.h (lang_do_assignments): Ditto.
	* emultempl/netbsd.em (gld${EMULATION_NAME}_before_parse): Declare.
	* Makefile.am (ens32knbsd.c): Depend on netbsd.em.
	* Makefile.in: Regenerate.

2003-12-03  Dave Airlie  <airlied@linux.ie>

	* configure.tgt: Add vax-linux-gnu target.

2003-12-03  Dmitry Diky  <diwil@mail.ru>
	
	* scripttempl/elf32msp430.sc (HEAP_SECTION_MSP430): New section for
	forthcoming devices.
	(_etext): provide this defenition for all scripts.

2003-12-02  Kazu Hirata  <kazu@cs.umass.edu>

	* emultempl/beos.em: Remove ARGSUSED.

2003-12-03  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/pe.em (pe_fixup_stdcalls): Update for renamed
	bfd_link_hash_entry field "next" -> "und_next".
	(pe_find_data_imports): Likewise.
	(gld_${EMULATION_NAME}_after_open): Likewise.
	* emultempl/sunos.em (before_allocation): Likewise.

2003-12-02  Nick Clifton  <nickc@redhat.com>

	* ld.texinfo (Options): --ignore-all is no longer the default
	behaviour for shared libraries and dynamic executables.

2003-12-02  Alan Modra  <amodra@bigpond.net.au>

	* Makefile.am: Run "make dep-am".
	* Makefile.in: Regenerate.

2003-12-02  Alan Modra  <amodra@bigpond.net.au>

	* ldmain.c (main): Remove mpc860c0 code.
	* lexsup.c (enum option_values): Delete OPTION_MPC860C0.
	(ld_options): Delete mpc860c0 entry.
	(parse_args): Likewise.

2003-12-01  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/elf32.em (gld${EMULATION_NAME}_before_allocation): Test
	hash table type rather than testing creator flavour.
	* emultempl/hppaelf.em (hppaelf_create_output_section_statements):
	Only create stub_file bfd if hash table creator is as expected.
	(gld${EMULATION_NAME}_finish): Test stub_file.

2003-11-28  Marcel Moolenaar  <marcel@xcllnt.net>

	* emulparams/elf64_ia64_fbsd.sh (TEXT_START_ADDR): Define.
	(DATA_ADDR): Unset.

2003-11-18  James E Wilson  <wilson@specifixinc.com>

	* ldlang.c (lang_process): Move lang_reset_memory_regions call after
	lang_do_assignments call.

	* emulparams/elf64_ia64.sh (OTHER_PLT_RELOC_SECTIONS): Include
	.rela.opd if -pie.

2003-11-10  Jonathan Wilson <jonwil@tpgi.com.au>

	* scripttempl/pe.sc: Add support for TLS sections.

2003-11-09  Alan Modra  <amodra@bigpond.net.au>

	* configure.host (HOSTING_LIBS): Group libgcc and libc with
	--start-group, --end-group pair.
	(*-*-netbsd*, am33_2.0-*-linux*): Use the default HOSTING_LIBS.
	(am33_2.0-*-linux*): Edit default HOSTING_CRT0.
	(arm*-*-linux-gnu*): Remove extraneous '*' in sed expression.
	(hppa*64*-*-linux*, hppa*-*-linux*): Remove target specific case.

2003-11-07  Jonathan R. Grant  <jg-binutils@jguk.org>

	* ldfile.c (ldfile_open_file): Use "No such file" error message.

2003-11-06  Bruno Rohee  <bruno@rohee.com>

	* ls.texinfo: Fix "the the" typo.

2003-11-05  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/pe.em (gld_${EMULATION_NAME}_after_open): Only do
	pe_dll_extra_pe_debug stuff when DLL_SUPPORT defined.
	(pr_sym): Move inside #ifdef DLL_SUPPORT.

	* emultempl/ppc64elf.em (gld${EMULATION_NAME}_new_vers_pattern): Zap
	unused variable.

	* emulparams/elf32_i860.sh (TEXT_START_ADDR): Define.

2003-11-04  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/elf32.em (gld${EMULATION_NAME}_before_allocation): Call
	_bfd_elf_tls_setup.

2003-10-31  Nick Clifton  <nickc@redhat.com>

	* ldlang.c (lookup_name): When looking for a previously loaded
	file compare the local_sym_name not the filename, as the
	filename might have been transformed via the search directory
	path lookup.
	If the sought-for file has not been found in the input file
	chain then create a new node with the search_dirs_flag set so
	that the entire set of directory paths will be scanned for it.

2003-10-30  Andrew Cagney  <cagney@redhat.com>

	* emultempl/pe.em, pe-dll.c: Replace "struct symbol_cache_entry"
	with "struct bfd_symbol".

2003-10-30 Phil Edwards <phil@codesourcery.com>

	* Makefile.am (ALL_EMULATIONS): Add elf32mipswindiss.o.
	(eelf32mipswindiss.c): New target.
	* Makefile.in:  Regenerated.
	* emulparams/elf32mipswindiss.sh:  New file.
	* configure.tgt (i[3-7]86-*-vxworks*, arm-*-vxworks, sh-*-vxworks,
	mips*-*-vxworks*):  Use ELF now.
	(mips*-*-windiss):  New stanza, use elf32mipswindiss.

2003-10-27  Stephane Carrez  <stcarrez@nerim.fr>

	* scripttempl/elfm68hc12.sc: Define eeprom memory region.

2003-10-25  Kazu Hirata  <kazu@cs.umass.edu>

	* ChangeLog-9197: Fix typos.
	* NEWS: Likewise.
	* ld.texinfo: Likewise.
	* ldlang.c: Fix comment typos.

2003-10-24  H.J. Lu  <hongjiu.lu@intel.com>

	* ldlang.c (lang_vers_match): Fix a typo.

2003-10-24  H.J. Lu  <hongjiu.lu@intel.com>

	* ldlang.c (lang_vers_match): Check demangled symbols.

2003-10-24  H.J. Lu  <hongjiu.lu@intel.com>

	* ldlang.c (lang_vers_match): Check "symbol" instead of
	"wildcard" and "pattern". Fix a typo.
	(lang_finalize_version_expr_head): Likewise.
	(lang_register_vers_node): Likewise.
	(realsymbol): New function.
	(lang_new_vers_pattern): Set "symbol" and remove "wildcard".

	* ldlex.l (V_IDENTIFIER): Allow '\\'.

2003-10-24  Nick Clifton  <nickc@redhat.com>

	* emultempl/m68hc1xelf.em (before_allocation): Add missing second
	parameter to lang_memory_region_lookup.

2003-10-22  Jakub Jelinek  <jakub@redhat.com>

	* ldlang.c: Include hashtab.h.
	(lang_vers_match_lang_c, lang_vers_match_lang_cplusplus,
	lang_vers_match_lang_java): Remove.
	(lang_vers_match): New function.
	(lang_new_vers_pattern): Initialize wildcard and mask
	fields, don't initialize match.
	(lang_new_vers_node): Use xcalloc.  Adjust for globals and
	locals field type changes.  Set match field.
	(version_expr_head_hash, version_expr_head_eq): New functions.
	(lang_finalize_version_expr_head): New function.
	(lang_register_vers_node): Call lang_finalize_version_expr_head.
	Search in hash table if not wildcard when looking for duplicates.
	* emultempl/ppc64elf.em (new_vers_pattern): Don't bother with
	duplicate checking.  Initialize all fields of dot_entry from entry
	with the exception of pattern and next.

2003-10-21  Nick Clifton  <nickc@redhat.com>

	* ldlang.c (lang_memory_region_lookup): Add second parameter -
	create - which is true if the region is being created.  Issue
	appropriate warning messages for finding and not finding
	already created regions.
	(lang_memory_default): Use DEFAULT_MEMORY_REGION.
	(lang_leave_overlay_section): Likewise.
	(lang_size_sections_1): Likewise.
	Pass second parameter to lang_memory_region_lookup.
	(lang_get_regions): Likewise.
	* ldlang.h (DEFAULT_MEMORY_REGION): Define.
	Update prototype for lang_memory_region_lookup.
	* ldgram.y: Pass second parameter to lang_memory_region_lookup.
	Use DEFAULT_MEMORY_REGION instead of "*default".

2003-10-20  Andrew Cagney  <cagney@redhat.com>

	* pe-dll.c: Replace "struct sec" with "struct bfd_section".

2003-10-19  Marek Michalkiewicz  <marekm@amelek.gda.pl>

	* Makefile.am: Remove old (before GCC 3.3) emulations for AVR
	target: avr1200, avr23xx, avr4433, avr44x4, avr85xx, avrmega103,
	avrmega161, avrmega603.  Default to avr2.
	* Makefile.in: Regenerate.
	* configure.tgt: Likewise.
	* emulparams/avr1200.sh: Remove.
	* emulparams/avr23xx.sh: Remove.
	* emulparams/avr4433.sh: Remove.
	* emulparams/avr44x4.sh: Remove.
	* emulparams/avr85xx.sh: Remove.
	* emulparams/avrmega103.sh: Remove.
	* emulparams/avrmega161.sh: Remove.
	* emulparams/avrmega603.sh: Remove.
	* scripttempl/elf32avr.sc: Remove.

2003-10-19  Andreas Schwab  <schwab@suse.de>

	* emultempl/ticoff.em (gld_${EMULATION_NAME}_list_options): Add
	newline to message.

	* deffilep.y: Remove commas from %token lines.

2003-10-18  Hans-Peter Nilsson  <hp@bitrange.com>

	* emultempl/mmix-elfnmmo.em (mmix_before_allocation): Force linker
	relaxation always; don't exclude relocatable linking.  Adjust for
	_bfd_mmix_prepare_linker_allocated_gregs renamed to
	_bfd_mmix_before_linker_allocation.
	(mmix_after_allocation): Adjust for
	_bfd_mmix_finalize_linker_allocated_gregs renamed to
	_bfd_mmix_after_linker_allocation.
	* scripttempl/mmo.sc: Use ADDR (.text), not . - SIZEOF (.text).

	* ldlang.c (lang_size_sections): Last, set _cooked_size for output
	sections.

2003-10-16  Alan Modra  <amodra@bigpond.net.au>

	* Makefile.am (GENSCRIPTS_EXTRA, GEN_EXTRA_DEPENDS): Remove.  Use
	GENSCRIPTS and GEN_DEPENDS in place of these.
	* Makefile.in: Regenerate.
	* genscripts_extra.sh: Delete.  Merge extra functionality to..
	* genscripts.sh: ..here.

	* emulparams/gld960.sh (TEXT_START_ADDR, TARGET_PAGE_SIZE): Define.
	* emulparams/gld960coff.sh (TEXT_START_ADDR, TARGET_PAGE_SIZE): Ditto.
	* emulparams/lnk960.sh (TEXT_START_ADDR, TARGET_PAGE_SIZE): Ditto.
	* emulparams/m88kbcs.sh (TEXT_START_ADDR, TARGET_PAGE_SIZE): Ditto.
	* emulparams/vanilla.sh (TEXT_START_ADDR, TARGET_PAGE_SIZE): Ditto.

2003-10-16  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ia64elf.em (gld${EMULATION_NAME}_after_parse): Don't
	use $EMULATION_NAME to call bfd function.

2003-10-14  Danny Smith  <dannysmith@users.sourceforge.net>

	* pe-dll.c (pe_implied_import_dll): Also scan .rdata sections
	to identify data symbols.

2003-10-13  Richard Sandiford  <rsandifo@redhat.com>

	* emulparams/elf32bmipn32-defs.sh (INITIAL_READONLY_SECTIONS): Move
	definition from elf64btsmip.sh.
	(TEXT_DYNAMIC): Likewise elf32btsmipn32.sh.
	* emulparams/elf32btsmipn32.sh (TEXT_DYNAMIC): Remove.
	* emulparams/elf64btsmip.sh (INITIAL_READONLY_SECTIONS): Remove.
	* emulparams/elf64bmip.sh (SHLIB_TEXT_START_ADDR): Define.
	(EXECUTABLE_SYMBOLS): Set __elf_header correctly for shared objects.
	Define __program_header_table in terms of __elf_header.

2003-10-10  H.J. Lu  <hongjiu.lu@intel.com>

	* Makefile.am (eelf64_ia64.c): Also depend on
	$(srcdir)/emultempl/ia64elf.em.
	* Makefile.in: Regenerated.

	* emulparams/elf64_ia64.sh (EXTRA_EM_FILE): Set to ia64elf.

	* emultempl/ia64elf.em: New.

2003-10-12  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* emulparams/shelf32_nbsd.sh (OTHER_SECTIONS): Redefine.

2003-10-11  Hans-Peter Nilsson  <hp@bitrange.com>

	* ld.texinfo (Builtin Functions) <DEFINED>: Say that only symbols
	defined before the statement using DEFINED yield 1.
	* ldexp.c (fold_name) <case DEFINED>: In lang_first_phase_enum,
	call lang_track_definedness on symbol.  In subsequent phases, use
	lang_symbol_definition_iteration and lang_statement_iteration to
	check whether the symbol was defined before the current statement.
	(exp_fold_tree) <case etree_assign et al>: Call
	lang_update_definedness before updating symbol type when setting
	symbol.
	* ldlang.c (lang_definedness_table): New variable.
	(lang_definedness_newfunc, lang_track_definedness)
	(lang_symbol_definition_iteration, lang_update_definedness): New
	functions.
	(lang_init): Initialize lang_definedness_table and
	lang_statement_iteration.
	(lang_finish): Destroy bfd_hash_table_free.
	(lang_size_sections): Increment lang_statement_iteration.
	(lang_do_assignments_1): New function with former
	lang_do_assignments contents.  Change recursive calls to call this
	function.
	(lang_do_assignments): Evacuate contents.  Increment
	lang_statement_iteration, then just call lang_do_assignments_1.
	* ldlang.h (struct lang_definedness_hash_entry)
	(lang_statement_iteration, lang_track_definedness)
	(lang_symbol_definition_iteration, lang_update_definedness):
	Declare.

2003-10-09  H.J. Lu  <hongjiu.lu@intel.com>

	* scripttempl/elf.sc (__executable_start): Provide.

2003-10-09  Daniel Jacobowitz  <drow@mvista.com>

	* emulparams/armelf.sh: Define NO_SMALL_DATA.
	* emulparams/armelf_linux.sh, emulparams/armelf_oabi.sh,
	emulparams/armnto.sh: Likewise.

2003-10-08  Alexandre Oliva  <aoliva@redhat.com>

	* ldlang.c (lang_size_sections_1): Use IGNORE_SECTION to tell
	whether to skip test for no memory region.

2003-10-08  Nick Clifton  <nickc@redhat.com>

	* lexsup.c (parse_args: OPTION_CALL_SHARED): Revise comment
	describing defaults.  Change default to report unresolved symbols
	in object files as well.

2003-10-08  Hans-Peter Nilsson  <hp@bitrange.com>

	* ldexp.c (fold_name) <case DEFINED>: Set section of result to
	abs_output_section.

2003-10-07  Bob Wilson  <bob.wilson@acm.org>

	* emulparams/elf32xtensa.sh (OTHER_READONLY_SECTIONS,
	OTHER_READWRITE_SECTIONS, OTHER_SECTIONS): Set section addresses to
	zero for relocatable links.

2003-10-07  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* configure.host (HOSTING_LIBS): Define for hppa*-*-linux*.

2003-10-07  Nathan Sidwell  <nathan@codesourcery.com>

	* ldwrite.c (unsplittable_name): New.
	(clone_section): Strip existing numeric suffix. Only truncate names
	for coff targets.
	(split_sections): Use unsplittable_name.

2003-10-06  Nick Clifton  <nickc@redhat.com>

	* lexsup.c (parse_args): Report unresolved symbols in shared
	libraries when creating a dynamic executable.  This is a
	restoration of the default behaviour for previous versions of
	the linker.

2003-10-06  Matt Thomas <matt@3am-software.com>

	* emulparams/hppanbsd.sh: Remove OUTPUT_FORMAT.
	* emulparams/hppaobsd.sh: Add OUTPUT_FORMAT="elf32-hppa".

2003-10-06  Robert Millan  <robertmh@gnu.org>

	* configure.tgt: Match GNU/KNetBSD with new knetbsd*-gnu triplet.

2003-10-02  Ivan Warren <ivan@vmfacility.fr>

	* pe-dll.c (make_one): Correct sym def order & pick right sym for
	.idata$7 reloc.

2003-09-30  Chris Demetriou  <cgd@broadcom.com>

	* NEWS: Add an indication of the cutoff for 2.14.

2003-09-30  Chris Demetriou  <cgd@broadcom.com>

	* ldmain.c (get_emulation): Ignore "-mips64r2".

2003-09-03  Robert Millan  <robertmh@gnu.org>

	* configure.host: Match GNU/KFreeBSD with new kfreebsd*-gnu
	triplet.
	* configure.tgt: Likewise.

2003-08-29  Jafa  <jafa@silicondust.com>

	* emulparams/elf32ip2k.sh (TEMPLATE_NAME): Define.

2003-08-21  Nick Clifton  <nickc@redhat.com>

	* po/tr.po: Updated Turkish translation.

2003-08-20  Nick Clifton  <nickc@redhat.com>

	* ldmain.c: Initialise the new fields in bfd_link_info to
	NOT_YET_SET.
	* lexsup.c (enum option_values): New enum.  Use this to
	replace the hand coded values for the long switch options.
	(ld_options): Add 'unresolved-symbols',
	'warn-unresolved-symbols' and 'error-unresolved-symbols'.
	(parse_args): Handle the new switches.  Set the values of
	unresolved_symbols_in_objects and
	unresolved_symbols_in_shared_libs appropriately.  If they were
	not initialised by the command line, install default values.
	* emultempl/elf32.em (handle_option): Update OPTION_GROUP and
	-z defs to use the new fields in bfd_link_info.
	* ld.texinfo: Document the new switches.
	* NEWS: Mention this feature.

2003-08-15 Dmitry Diky <diwil@mail.ru>

	* Makefile.am (GENSCRIPTS_EXTRA): New script definition which
	calls genscripts_extra.sh.
	Rearrange all msp430 depends using this script.
	* Makefile.in: Regenerate.
	* genscripts_extra.sh: New file: Similar to genscripts.sh, except
	that the script to be run to generate the emulations can be passed
	as an optional parameter instead of being computed from the
	emulation name.
	* emulparams/msp430all.sh: New file: Combine all msp430 subdevice
	definitions into one file.
	* emulparams/msp430x*.sh: Removed.

2003-08-15  Nick Clifton  <nickc@redhat.com>

	* ld.texinfo (Options): Put keywords for the -z option into a
	table.  Add more text describing what the -z now option does.

2003-08-14  Alan Modra  <amodra@bigpond.net.au>

	* dep-in.sed: Remove libintl.h.
	* Makefile.am (POTFILES.in): Unset LC_COLLATE.
	* Makefile.in: Regenerate.

2003-08-13  Alan Modra  <amodra@bigpond.net.au>

	* genscripts.sh (libpath.exp): Only generate for first emulation.
	(LIB_PATH): Correct order of paths.  Don't add $tool_lib when
	already present or when LIB_PATH is set to ":".

2003-08-12  Ian Lance Taylor  <ian@airs.com>

	* ldmain.c (undefined_symbol): Change parameter name from `fatal'
	to `error'.  If only a warning, put warning in the reported
	string.  Consistently set failure flag when not a warning.

2003-08-08 Dmitry Diky <diwil@mail.ru>

	* Makefile.am: Add xW42 and xE42 parts. Sort MPU list according to
	gcc order.
	* Makefile.in: Regenerate.
	* configure.tgt: Add extra emulations.
	* emulparams/msp430xE423.sh: New file.
	* emulparams/msp430xE427.sh: New file.
	* emulparams/msp430xW425.sh: New file.
	* emulparams/msp430xE425.sh: New file.
	* emulparams/msp430xW423.sh: New file.
	* emulparams/msp430xW427.sh: New file.

2003-08-07  Danny Smith  <dannysmith@users.sourceforge.net>

	* emultempl/pe.em (gld_${EMULATION_NAME}_before_parse):
	Change second (cmdline) arg to lang_add_entry to FALSE.
	(set_pe_subsystem): Change second arg to lang_add_entry to TRUE.

2003-08-05  Christian Groessler  <chris@groessler.org>
	    Jason Eckhardt  <jle@rice.edu>

	* configure.tgt: Recognize new target i860-*-coff.
	* Makefile.am (ALL_EMULATIONS): Add ecoff_i860.o.
	(ecoff_i860.c): New rule.
	* emulparams/coff_i860.sh: New file.
	* scripttempl/i860coff.sc: New file.
	* Makefile.in: Regenerate.

2003-08-04  Nick Clifton  <nickc@redhat.com>

	* emultempl/elf32.em (before_allocation): Prepend "warning: "
	to messages produced for .gnu.warning.SYMBOL sections.

2003-08-04  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/elf32.em (output_rel_find): Add "isdyn" param.  Put
	.rel.dyn before other reloc sections.  Don't stop looking for reloc
	sections on finding one that isn't allocated.  Match .rel even when
	placing .rela and vice versa, when setting last_rel and
	last_rel_alloc for the first time.  If no reloc sections in script,
	prefer allocated section over non-alloc.
	(gld${EMULATION_NAME}_place_orphan): Handle orphan .rel.dyn.

2003-07-29  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* emulparams/shelf.sh (OTHER_SECTIONS): Don't include .stack
	section for shared library.
	* emulparams/shelf32.sh (OTHER_SECTIONS): Likewise.
	* emulparams/shelf64.sh (OTHER_SECTIONS): Likewise.

2003-07-29  Stephane Carrez  <stcarrez@nerim.fr>

	* scripttempl/elfm68hc12.sc: Add gcc_except_table.
	* scripttempl/elfm68hc11.sc: Likewise.

2003-07-28  Alan Modra  <amodra@bigpond.net.au>

	* emulparams/elf64ppc.sh (GOT): Fix for shell brace matching.

	* emulparams/elf64ppc.sh (GOT): Don't merge .toc into .got for ld -r.

2003-07-27  Alan Modra  <amodra@bigpond.net.au>

	* ld.texinfo: Typo fixes.  Document SUBALIGN.
	* ldgram.y (opt_subalign): Add.
	* ldlex.l (SUBALIGN): Recognize.
	* ldlang.c (overlay_subalign): New var.
	(lang_enter_overlay): Add subalign param.
	(lang_enter_overlay_section): Pass overlay_subalign to
	lang_enter_output_section_statement.
	* ldlang.h (lang_enter_overlay): Update.

2003-07-24  Nick Clifton  <nickc@redhat.com>

	* po/fr.po: Updated French translation.

2003-07-23  Stephane Carrez  <stcarrez@nerim.fr>

	* scripttempl/elfm68hc11.sc: Keep ctor/dtor sections; Take into
	account .tramp sections;
	* scripttempl/elfm68hc12.sc: Likewise.

2003-07-17  Charles Wilson  <cwilson@ece.gatech.edu>

	* ld/pe-dll.c: Add libcygwin to autofilter_liblist[]

2003-07-17  Nick Clifton  <nickc@redhat.com>

	* po/es.po: New Spanish translation.

2003-07-11  Alan Modra  <amodra@bigpond.net.au>

	* po/ld.pot: Regenerate.

2003-07-10  Bob Wilson  <bob.wilson@acm.org>

	* emulparams/elf32xtensa.sh (OTHER_READONLY_SECTIONS): Replace .xt.lit
	with new .got.loc section.
	(OTHER_READWRITE_SECTIONS): Do not combine linkonce sections for
	non-relocating links.
	(OTHER_SECTIONS): Add .xt.lit here.  Change it to keep linkonce
	sections separate for non-relocating links; likewise for .xt.insn.

2003-07-10  Alexandre Oliva  <aoliva@redhat.com>

	2001-08-22  Alexandre Oliva  <aoliva@redhat.com>
	* emulparams/elf32am33lin.sh: Adjust to match kernel parameters.
	2001-05-09  Alexandre Oliva  <aoliva@redhat.com>
	* configure.host (am33_2.0-*-linux*): Added.
	* configure.tgt (am33_2.0-*-linux*): Likewise.
	* emulparams/elf32am33lin.sh: New.
	* Makefile.am (eelf32am33lin.c): New rule.
	* Makefile.in: Rebuilt.

2003-07-09  Alexandre Oliva  <aoliva@redhat.com>

	2001-04-17  Alexandre Oliva  <aoliva@redhat.com>
	* emulparams/mn10300.sh (TEMPLATE_NAME): Define.
	(GENERATE_SHLIB_SCRIPT): Likewise.

2003-07-10  Alan Modra  <amodra@bigpond.net.au>

	* emulparams/elf64ppc.sh (OTHER_GOT_SECTIONS): Don't define.
	(GOT): Define.
	* emultempl/ppc64elf.em (stub_added): New static var.
	(ppc_create_output_section_statements): Call ppc64_elf_init_stub_bfd.
	(ppc_add_stub_section): Set stub_added.
	(gld${EMULATION_NAME}_finish): Look for .got rather than .toc.  Adjust
	ppc64_elf_size_stubs call and test for stubs.
	* scripttempl/elf.sc (GOT): Define and use.

2003-07-08  J"orn Rennecke <joern.rennecke@superh.com>

	* emultempl/sh64elf.em (sh64_elf_${EMULATION_NAME}_after_allocation):
	Allow second call from ldemul_finish.

2003-07-04  J"orn Rennecke <joern.rennecke@superh.com>

	* emulparams/shelf32.sh (STACK_ADDR): Don't define.
	(OTHER_SECTIONS): Include .stack.
	* emulparams/shelf64.sh (OTHER_SECTIONS): Likewise.

2003-07-02  Jakub Jelinek  <jakub@redhat.com>

	* emulparams/elf64_ia64.sh (OTHER_READONLY_SECTIONS): Don't include
	.opd if -pie.
	(OTHER_READWRITE_SECTIONS): Include .opd if -pie.
	* scripttempl/elf.sc: Use SHLIB_DATA_ADDR instead of DATA_ADDR
	if -pie.

2003-06-28  Alan Modra  <amodra@bigpond.net.au>

	* ld.h: Convert to C90, remove unnecessary prototypes and casts.
	Replace PTR with void *.  Formatting.
	* ldcref.c: Likewise.
	* ldctor.c: Likewise.
	* ldctor.h: Likewise.
	* ldemul.h: Likewise.
	* ldexp.c: Likewise.
	* ldexp.h: Likewise.
	* ldfile.c: Likewise.
	* ldfile.h: Likewise.
	* ldlang.c: Likewise.
	* ldlang.h: Likewise.
	* ldlex.h: Likewise.
	* ldlex.l: Likewise.
	* ldmain.c: Likewise.
	* ldmain.h: Likewise.
	* ldmisc.c: Likewise.
	* ldmisc.h: Likewise.
	* ldver.h: Likewise.
	* ldwrite.c: Likewise.
	* ldwrite.h: Likewise.
	* lexsup.c: Likewise.
	* mri.c: Likewise.
	* mri.h: Likewise.
	* pe-dll.c: Likewise.
	* pe-dll.h: Likewise.
	* deffilep.y: Likewise.
	* deffile.h: Likewise.  Don't include ansidecl.h.
	* emulparams/elf32mcore.sh: Remove unnecessary cast.
	* emultempl/m68kcoff.em: Likewise.
	* emultempl/m68kelf.em: Likewise.
	* emultempl/ticoff.em: Remove lang_add_output_format declaration.
	* sysdep.h: Don't include ansidecl.h.
	* Makefile.am: Run "make dep-am".
	* Makefile.in: Regenerate.

2003-06-27  Nick Clifton  <nickc@redhat.com>

	* deffilep.y (def_file_add_directive): Cope with NUL seperated
	directives.  Fix reporting of unparseable directives.
	(def_error): Check for a NULL def_filename.

2003-06-27  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/aix.em: Convert to C90, remove unnecessary prototypes
	and casts.  Replace PTR with void *.  Formatting.
	* emultempl/alphaelf.em: Likewise.
	* emultempl/armcoff.em: Likewise.
	* emultempl/armelf.em: Likewise.
	* emultempl/armelf_oabi.em: Likewise.
	* emultempl/beos.em: Likewise.
	* emultempl/elf32.em: Likewise.
	* emultempl/generic.em: Likewise.
	* emultempl/gld960.em: Likewise.
	* emultempl/gld960c.em: Likewise.
	* emultempl/hppaelf.em: Likewise.
	* emultempl/linux.em: Likewise.
	* emultempl/lnk960.em: Likewise.
	* emultempl/m68hc1xelf.em: Likewise.
	* emultempl/m68kcoff.em: Likewise.
	* emultempl/m68kelf.em: Likewise.
	* emultempl/mipsecoff.em: Likewise.
	* emultempl/mipself.em: Likewise.
	* emultempl/mmix-elfnmmo.em: Likewise.
	* emultempl/mmixelf.em: Likewise.
	* emultempl/mmo.em: Likewise.
	* emultempl/needrelax.em: Likewise.
	* emultempl/netbsd.em: Likewise.
	* emultempl/pe.em: Likewise.
	* emultempl/sh64elf.em: Likewise.
	* emultempl/sunos.em: Likewise.
	* emultempl/ticoff.em: Likewise.
	* emultempl/vanilla.em: Likewise.
	* emultempl/xtensaelf.em: Likewise.
	* Makefile.am: Correct dependencies.
	* Makefile.in: Regenerate.

2003-06-25  Alan Modra  <amodra@bigpond.net.au>

	* ld.texinfo: Correct spelling of "relocatable".
	* ldctor.c: Likewise.
	* ldexp.c: Likewise.
	* ldfile.c: Likewise.
	* ldint.texinfo: Likewise.
	* ldlang.c: Likewise.
	* ldmain.c: Likewise.
	* ldwrite.c: Likewise.
	* lexsup.c: Likewise.
	* emultempl/aix.em: Likewise.
	* emultempl/alphaelf.em: Likewise.
	* emultempl/armcoff.em: Likewise.
	* emultempl/armelf_oabi.em: Likewise.
	* emultempl/beos.em: Likewise.
	* emultempl/elf32.em: Likewise.
	* emultempl/generic.em: Likewise.
	* emultempl/gld960.em: Likewise.
	* emultempl/gld960c.em: Likewise.
	* emultempl/hppaelf.em: Likewise.
	* emultempl/linux.em: Likewise.
	* emultempl/lnk960.em: Likewise.
	* emultempl/m68hc1xelf.em: Likewise.
	* emultempl/m68kcoff.em: Likewise.
	* emultempl/m68kelf.em: Likewise.
	* emultempl/mipsecoff.em: Likewise.
	* emultempl/mipself.em: Likewise.
	* emultempl/mmix-elfnmmo.em: Likewise.
	* emultempl/mmo.em: Likewise.
	* emultempl/needrelax.em: Likewise.
	* emultempl/pe.em: Likewise.
	* emultempl/ppc64elf.em: Likewise.
	* emultempl/sh64elf.em: Likewise.
	* emultempl/sunos.em: Likewise.
	* emultempl/ticoff.em: Likewise.
	* emultempl/xtensaelf.em: Likewise.

2003-06-24  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc32elf.em: Convert to C90.

2003-06-20  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em: Convert to C90 function definitions, remove
	unnecessary prototypes and casts.

2003-06-19  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em (gld${EMULATION_NAME}_finish): Dump out
	statistics from ppc64_elf_build_stubs.

2003-06-19  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em (build_section_lists): Check return status
	from ppc64_elf_next_input_section.

2003-06-17  H.J. Lu <hongjiu.lu@intel.com>

	* ldlang.c (section_already_linked): Put back assignment of
	kept_section.

2003-06-17  Rainer Keuchel  <rkeuchel@allgeier.com>

	* pe-dll.c (generate_reloc): Catch and ignore an ARM_26D
	reloc.

2003-06-17  Loren James Rittle  <rittle@latour.rsch.comm.mot.com>

	* configure.host (*-*-freebsd*): Add known path for ld-elf.so.1
	if not produced by gcc.

2003-06-16  Hans-Peter Nilsson  <hp@axis.com>

	* configure.tgt: Add specific case for cris-*-linux-gnu*
	with crislinux emulation only.

2003-06-13  Robert Millan  <zeratul2@wanadoo.es>

	* configure.tgt: Add i386-netbsd-gnu target.

2003-06-12  Richard Sandiford  <rsandifo@redhat.com>

	* configure.tgt (mips*-sgi-irix6*): Add the o32 and n64 emulations
	to $targ_extra_libpath.

2003-06-11  H.J. Lu <hongjiu.lu@intel.com>

	* po/Make-in (DESTDIR): New.
	(install-data-yes): Support $(DESTDIR).
	(uninstall): Likewise.

2003-06-10  Doug Evans  <dje@sebabeach.org>

	* Makefile.am (ALL_EMULATIONS): Add em32relf.o.
	* Makefile.in: Regenerate.

2003-06-10  Richard Sandiford  <rsandifo@redhat.com>

	* configure.tgt (h8300*): Add h8300sxn emulations.
	* Makefile.am (ALL_EMULATIONS): Add eh8300sxn.o and eh8300sxnelf.o.
	(eh8300sxn.c, eh8300sxnelf.c): New rules.
	* Makefile.in: Regenerate.
	* emulparams/h8300sxnelf.sh, emulparams/h8300sxn.sh: New files.
	* scripttempl/h8300sxn.sc: New file.

2003-06-10  Alan Modra  <amodra@bigpond.net.au>

	* emulparams/elf64ppc.sh (EXECUTABLE_SYMBOLS, OTHER_BSS_END_SYMBOLS,
	CTOR_START, CTOR_END, DTOR_START, DTOR_END): Don't define.

2003-06-08  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em (emit_stub_syms, toc_section): New vars.
	(build_toc_list): New function.
	(gld${EMULATION_NAME}_finish): Call build_toc_list and
	ppc64_elf_reinit_toc.  Adjust ppc64_elf_build_stubs call.
	(OPTION_STUBSYMS): Define.
	(PARSE_AND_LIST_LONGOPTS): Add emit-stub-syms.
	(PARSE_AND_LIST_OPTIONS): Document.
	(PARSE_AND_LIST_ARGS_CASES): Handle.

2003-06-05  Roland McGrath  <roland@redhat.com>

	* emultempl/elf32.em (gld${EMULATION_NAME}_list_options): Remove
	extra \t in -z noexecstack line.

2003-05-23  Jakub Jelinek  <jakub@redhat.com>

	* ldgram.y (phdr_type): Grok PT_GNU_STACK.
	* emultempl/elf32.em (gld${EMULATION_NAME}_handle_option): Add
	-z execstack and -z noexecstack.
	(gld${EMULATION_NAME}_list_options): Likewise.
	* scripttempl/elf.sc: If not -r, discard .note.GNU-stack section.

2003-06-03  Michael Snyder  <msnyder@redhat.com>
	and Bernd Schmidt   <bernds@redhat.com>
	and Alexandre Oliva <aoliva@redhat.com>

	* Makefile.am: Add new emulations for h8300sx.
	* Makefile.in: Regenerate.
	* configure.tgt: Add new emulations.
	* emulparams/h8300sx.sh: New emulation.
	* emulparams/h8300sxelf.sh: Ditto.
	* scripttempl/h8300sx.sc: Ditto.

2003-06-03  H.J. Lu <hongjiu.lu@intel.com>

	* ldmisc.c: Include "bfdlink.h".
	(error_handler): Handle LD_DEFINITION_IN_DISCARDED_SECTION
	and -LD_DEFINITION_IN_DISCARDED_SECTION.

	* Makefile.am: Rebuild dependency.
	* Makefile.in: Regenerated.

2003-06-03  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* emulparams/shlelf_linux.sh (GENERATE_PIE_SCRIPT): Set to yes.
	* emulparams/shlelf32_linux.sh (GENERATE_PIE_SCRIPT): Likewize.

2003-06-02  Fabrizio Gennari  <fabrizio.ge@tiscalinet.it>

	* pe-dll.c (fill_edata): Scan table pe_dll->exports, which is
	sorted alphabetically, instead of exported_symbols, which is
	sorted by ordinal.

2003-05-30  Ulrich Drepper  <drepper@redhat.com>
	    Jakub Jelinek  <jakub@redhat.com>

	* lexsup.c (OPTION_PIE): Define.
	(ld_options): Add -pie and --pic-executable options.
	(parse_args): Handle OPTION_PIE.
	* ldmain.c (main): Initialize link_info.pie and
	link_info.executable.
	* genscripts.sh: Generate PIE scripts.
	* ld.texinfo: Document -pie and --pic-executable options.
	* emultempl/elf32.em (gld${EMULATION_NAME}_after_open):
	(gld${EMULATION_NAME}_place_orphan): Likewise.
	(gld${EMULATION_NAME}_get_script): Include PIE scripts.
	* scripttempl/elf.sc: In PIE scripts set . the same way as in
	shared scripts.
	* emulparams/elf_i386.sh (GENERATE_PIE_SCRIPT): Set to yes.
	* emulparams/elf64_ia64.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf32ppc.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf64ppc.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf_x86_64.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf_s390.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf32_sparc.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf64_sparc.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf64alpha.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf64_s390.sh (GENERATE_PIE_SCRIPT): Likewise.
	* emulparams/elf_i386.sh (GENERATE_PIE_SCRIPT): Likewise.

2003-05-30  H.J. Lu <hongjiu.lu@intel.com>

	* genscripts.sh: Create tmpdir/libpath.exp.

2003-05-30  Nick Clifton  <nickc@redhat.com>

	* emultempl/armelf.em (arm_elf_before_allocation): Replace ASSERT
	with a test for a NULL bfd_for_interworking.

2003-05-29  Jason Thorpe  <thorpej@wasabisystems.com>

	* configure.host (*-*-netbsd*): Set HOSTING_CRT0 and HOSTING_LIBS
	correctly for more recent versions of NetBSD.
	(alpha*-*-netbsd*): Remove.
	(i[3-7]86-*-netbsd*): Remove.

2003-05-29  Nick Clifton  <nickc@redhat.com>

	* emultempl/pe.em: Include "safe-ctype.h" instead of <ctype.h>.

2003-05-26  Maciej W. Rozycki  <macro@ds2.pg.gda.pl>

	* emulparams/elf64btsmip.sh: Set TEXT_START_ADDR to 0x120000000 to
	trap on pointer crops.

2003-05-21  Marcus Comstedt  <marcus@mc.pp.se>

	* configure.tgt: Check for a target triplet of shl-...-netbsdelf
	as well as shle-...-netbsdelf.

2003-05-16  Kelley Cook  <kelleycook@wideopenwest.com>

	* configure.host: Accept i[3-7]86 variants.
	* configure.tgt: Likewise.

2003-05-15  H.J. Lu <hongjiu.lu@intel.com>

	* emulparams/elf64_ia64.sh: Don't set COMMONPAGESIZE for now.

2003-05-09  Daniel Jacobowitz  <drow@mvista.com>

	* Makefile.am (ALL_EMULATIONS): Add earmelfb.o and earmelfb_linux.o.
	(earmelfb.c, earmelfb_linux.c): New rules.
	* Makefile.in: Regenerated.
	* emulparams/armelfb.sh, emulparams/armelfb_linux.sh: New files.
	* configure.tgt: Add armeb-elf and arm*b-*-linux-gnu.

2003-05-09  Nick Clifton  <nickc@redhat.com>

	* ldlang.c (lang_size_sections_1): Default to generating a
	fatal error message if a loadable section is not allocated
	to a memory region when regions are defined.

2003-05-09  Alan Modra  <amodra@bigpond.net.au>

	* Makefile.am (em68hc11elf.c): Correct dependencies.
	(em68hc11elfb.c, em68hc12elf.c, em68hc12elfb.c): Likewise.
	* Makefile.in: Regenerate.
	* emultempl/elf32.em (find_exp_assignment): Adjust for changed
	bfd_elf_record_link_assignment name.

2003-05-07  Alexandre Oliva  <aoliva@redhat.com>

	* ldmain.h (overflow_cutoff_limit): Declare.
	* ldmain.c (overflow_cutoff_limit): Define, initialized to 10.
	(reloc_overflow): Limit error messages based on it.
	* lexsup.c (parse_args) <OPTION_VERBOSE>: Set cutoff to
	unlimited.

2003-05-05  Alan Modra  <amodra@bigpond.net.au>

	* ldlex.l: Accept C style comments in version scripts.

2003-04-28  H.J. Lu <hjl@gnu.org>

	* ldlang.c (lang_process): Add the relax finalize pass.

	* ldmain.c (main): Initialize link_info.relax_finalizing to
	FALSE.

2003-04-24  Roland McGrath  <roland@redhat.com>

	* ldgram.y (phdr_type): Grok PT_TLS and PT_GNU_EH_FRAME names.
	If a name string is unknown, give an error rather than crashing later.

2003-04-23 Dhananjay Deshpande <dhananjayd@kpitcummins.com>

	* Makefile.am (ALL_EMULATIONS): Add eh8300hn.o, eh8300sn.o,
	eh8300hnelf.o, eh8300snelf.o and respective rules.
	* Makefile.in: Regenerate.
	* configure.tgt: Add h8300hn, h8300sn, h8300hnelf, h8300snelf
	* emulparams/h8300hn.sh: New
	* emulparams/h8300sn.sh: New
	* emulparams/h8300hnelf.sh: New
	* emulparams/h8300snelf.sh: New
	* scripttempl/h8300hn.sc: new
	* scripttempl/h8300sn.sc: new

2003-04-23  H.J. Lu <hjl@gnu.org>

	* ldmain.c (link_callbacks): Initialize error_handler.

	* ldmisc.c (error_handler): New function.

	* ldmisc.h (error_handler): New prototype.

2003-04-21  Stephane Carrez  <stcarrez@nerim.fr>

	* emulparams/m68hc11elf.sh: Use m68hc1xelf.em extra.
	* emulparams/m68hc11elfb.sh: Likewise.
	* emulparams/m68hc12elf.sh: Likewise.
	* emulparams/m68hc12elfb.sh: Likewise.

2003-04-19  Stephane Carrez  <stcarrez@nerim.fr>

	* emultempl/m68hc1xelf.em: New file to generate far trampolines on
	68HC11 and 68HC12.
	(LDEMUL_BEFORE_ALLOCATION): Override to gather the trampolines to
	generate.
	(LDEMUL_FINISH): Override to generate the trampolines after gc and
	linker relaxation.
	(LDEMUL_CREATE_OUTPUT_SECTION_STATEMENTS): Override to create the
	stub file for trampolines.
	(PARSE_AND_LIST_OPTIONS, PARSE_AND_LIST_LONGOPTS): New options
	--no-trampoline and --bank-window to control the memory bank window.

2003-04-18  H.J. Lu <hjl@gnu.org>

	* ldfile.c (ldfile_add_library_path): Remove the unused
	variable.

2003-04-18  Andrew Haley  <aph@cambridge.redhat.com>

	* scripttempl/xstormy16.sc (__data, __rdata): New.

2003-04-16  Nick Clifton  <nickc@redhat.com>

	* scripttempl/xstormy16.sc: Add .jcr section mapping.

2003-04-15  H.J. Lu <hjl@gnu.org>

	From Debian by Jack Howarth <howarth@nitro.med.uc.edu>:

	* ldlex.l: Use YY_CURRENT_BUFFER instead of yy_current_buffer.

2003-04-15  Rohit Kumar Srivastava <rohits@kpitcummins.com>

	* h8-doc.texi: Replace occurrances of 'Hitachi' with 'Renesas'.
	* ld.texinfo: Likewise.

2003-04-14  Alan Modra  <amodra@bigpond.net.au>

	From Prashanth Tamraparni <prashanth_t@in.ibm.com>
	* scripttempl/elf.sc (CTOR): Handle crtbeginS.o, crtendS.o and
	other variants of crtbegin.o, crtend.o.
	(DTOR): Likewise.
	* scripttempl/crisaout.sc (ctors, dtors): Likewise.
	* scripttempl/elf_chaos.sc (CTOR, DTOR): Likewise.
	* scripttempl/elfd10v.sc (CTOR, DTOR): Likewise.
	* scripttempl/elfd30v.sc (CTOR, DTOR): Likewise.
	* scripttempl/elfxtensa.sc (CTOR, DTOR): Likewise.
	* scripttempl/iq2000.sc (CTOR, DTOR): Likewise.
	* scripttempl/mmo.sc (ctors, dtors): Likewise.
	* scripttempl/xstormy16.sc (CTOR, DTOR): Likewise.

2003-04-09   Dmitry Diky  <diwil@mail.ru>

	* scripttempl/elf32msp430.sc: Add initX, finiX, ctors, dtors
	sections to respect C++  constructor/destructor. Add ctors/dtors
	start/stop definitions.
	* scripttempl/elf32msp430_3.sc: Likewise.

2003-04-06  Nick Clifton  <nickc@redhat.com>

	* ld.texinfo (Options): Add a reminder of the target specific
	nature to the description of the i386 PE specific options, for
	readers who have not read all the way through the manual.

2003-04-04  Svein E. Seldal  <Svein.Seldal@solidas.com>

	* configure.tgt: Fixed bug in list of targ_extra_emuls.
	* emulparams/tic3xcoff.sh (SCRIPT_NAME): Namespace
	cleanup. Replace s/c4x/tic4x and s/c3x/tic3x/
	* emulparams/tic3xcoff_onchip.sh: Ditto
	* emulparams/tic4xcoff.sh: Ditto
	* scripttempl/tic4xcoff.sc: Ditto

2003-04-03  Nick Clifton  <nickc@redhat.com>

	* NEWS: Mention support for Xtensa architecture.

2003-04-02  Nick Clifton  <nickc@redhat.com>

	* pe-dll.c (pe_detail_list): arm-pe targets use underscores.

2003-04-01  Danny Smith <dannysmith@users.sourceforge.net>

	* emultempl/pe.em (gld_${EMULATION_NAME}_after_open):
	Don't call pe_dll_build_section() if link_info.relocateable.
	(gld_${EMULATION_NAME}_finish): Don't call pe_dll_fill_sections()
	if link_info.relocateable.

2003-04-01  Fabrizio Gennari  <fabrizio.ge@tiscalinet.it>

	* pe-dll.c (process_def_file): Don't create an export
	section if there are no exports and we're building an exe
	(pe_dll_build_sections): Ditto
	(pe_dll_fill_sections): Conditionalize setting
	abfd->dll true on info->shared
	* emultempl/pe.em (gld_${EMULATION_NAME}_after_open):
	If i386pe or armpe, call pe_dll_build_section()
	for both exe's and dll's, not just dll's.
	(gld_${EMULATION_NAME}_finish): For all targets except
	shpe and mipspe, call pe_dll_fill_sections() for both
	exe's and dll's, not just dll's.

2003-04-02  Bob Wilson  <bob.wilson@acm.org>

	* emulparams/xtensa-config.sh: Remove comment indicating that this is
	a generated file.

2003-04-01  Bob Wilson  <bob.wilson@acm.org>

	* Makefile.am (ALL_EMULATIONS): Add eelf32xtensa.o.
	(eelf32xtensa.c): New target.
	* Makefile.in: Regenerate.
	* configure.tgt: Handle xtensa-*-*.
	* gen-doc.texi: Set XTENSA variable.
	* ld.texinfo: Set XTENSA variable.  Add new Xtensa node.
	* emulparams/elf32xtensa.sh: New file.
	* emulparams/xtensa-config.sh: Likewise.
	* emultempl/xtensaelf.em: Likewise.
	* scripttempl/elfxtensa.sc: Likewise.

2003-04-01  Jakub Jelinek  <jakub@redhat.com>

	* configure.tgt (powerpc*-*-linux*): Add elf32ppc to ppc64
	targ_extra_libpath.  Add elf64ppc to ppc targ_extra_libpath
	if --enable-64-bit-bfd.

2003-04-01  Nick Clifton  <nickc@redhat.com>

	* emulparams/armelf.sh (OTHER_READONLY_SECTIONS): Change name of
	note section.
	* emulparams/armelf_linux.sh (OTHER_READONLY_SECTIONS): Change
	name of note section.

2003-03-31  Alexandre Oliva  <aoliva@redhat.com>

	* ld.texinfo (-Tbss, -Tdata, -Ttext): Document in terms of
	--section-start.

2003-03-31  David Heine  <dlheine@suif.stanford.edu>

	* ldfile.c (ldfile_add_library_path): Always allocate space for
	the filename.
	* ldlang.c (lang_register_vers_node): Free the node if it cannot
	be used.
	* ldmain.c (set_scripts_dir): Always free the constructed
	directory name.
	(add_keepsyms_file): Fix memory leak.
	* ldmisc.c (vfinfo): Likewise.
	* lexsup.c (parse_args): Likewise.

2003-03-25  Stan Cox   <scox@redhat.com>
	    Nick Clifton  <nickc@redhat.com>

	Contribute support for Intel's iWMMXt chip - an ARM variant:

	* emulparams/armelf.sh (OTHER_READONLY_SECTIONS): Define.
	* emulparams/armelf_linux.sh (OTHER_READONLY_SECTIONS): Define.
	* scripttempl/armcoff.sc (.data): Ensure 8 byte alignment.
	(.bss): Likewise.

2003-03-25  Alexandre Oliva  <aoliva@redhat.com>

	* ldmain.h (ld_canon_sysroot, ld_canon_sysroot_len): Declare.
	* ldmain.c (ld_canon_sysroot, ld_canon_sysroot_len): Define.
	(main): Initialize them.
	* ldfile.c: Include pathnames.h.
	(is_sysrooted_pathname): New.
	(ldfile_add_library_path): Use it.
	(ldfile_open_file_search): Likewise.  Use IS_ABSOLUTE_PATH.  Don't
	search_dirs if given an absolute pathname.
	(ldfile_open_file): Issue error message for sysrooted
	absolute pathnames.
	* Makefile.am: Updated dependencies.
	* Makefile.in: Rebuild.

2003-03-24  Daniel Néri  <dne@mayonnaise.net>

	* ld.texinfo: Rename all occurances of C54X to TIC54X.

2003-03-19  Andreas Schwab  <schwab@suse.de>

	* ldfile.c (ldfile_try_open_bfd): Pop lexer start condition after
	eof.

2003-03-18  Danny Smith  <dannysmith@users.sourceforge.net>

	* deffilep.y (opt_base): If no number given, set to default
	(-1), not 0.

2003-03-13  Danny Smith  <dannysmith@users.sourceforge.net>

	* deffilep.y (def_import): Use default extension of "dll"
	if no extension provided in parsed IMPORT definition.

	* deffilep.y (def_lex): Revert 2003-03-12 change.
	(dot_name): New id type and rule.
	(expline): Use instead of ID.
	(opt_equal_name): Likewise.

2003-03-12  Danny Smith  <dannysmith@users.sourceforge.net>

	* deffilep.y (def_lex): Accept '.' as valid non-lead char.

2003-03-07  Christopher Faylor  <cgf@redhat.com>

	* configure.tgt: Add NATIVE_LIB_DIRS for cygwin target back after
	apparent accidental removal on 2003-01-06.

2003-03-04  Dmitry Diky  <diwil@mail.ru>

	* Makefile.am: Add new devices x1122 x1132 emulation
	* configure.tgt: Likewise.
	* Makefile.in: Regenerate.
	* emulparams/msp430x1122.sh: New file.
	* emulparams/msp430x1132.sh: New file.

2003-03-03  Alexandre Oliva  <aoliva@redhat.com>

	* ldmain.c (set_scripts_dir): Look for relative to TOOLBINDIR as
	well.

	* ldfile.h (struct search_dirs): Added sysrooted field.
	* ldlang.h (struct lang_input_statement_struct): Likewise.
	* ldfile.c (ldfile_add_library_path): Mark sysrooted paths.
	(ldfile_open_file_search): Look for sysrooted filename starting
	with / in ld_sysroot instead of in the current directory.  Clear
	sysrooted flag if it's found in the current directory.  Set it
	from the search directory's sysrooted flag where it is found
	otherwise.
	* ldlang.c (ldlang_sysrooted_script): New static variable.
	(new_afile): Mark search_file_enums as sysrooted if
	ldlang_sysrooted_script.
	(load_symbols): Set ldlang_sysrooted_script according to the
	script's sysrooted field while processing it.
	* ld.texinfo: Document INPUT behavior in sysroot.

2003-03-02  Danny Smith  <dannysmith@users.sourceforge.net>

	* scripttempl/pe.sc: Use PROVIDE with etext, end, _end,

2003-03-03  Alan Modra  <amodra@bigpond.net.au>

	* emulparams/elf64alpha.sh (EXTRA_EM_FILE): Define.
	(PARSE_AND_LIST_PROLOGUE, PARSE_AND_LIST_LONGOPTS,
	PARSE_AND_LIST_OPTIONS, PARSE_AND_LIST_ARGS_CASES,
	PARSE_AND_LIST_EPILOGUE): Don't define.
	* emultempl/alphaelf.em: New file.

2003-03-01  Alan Modra  <amodra@bigpond.net.au>

	* ldemul.c: Include getopt.h.
	* emultempl/elf32.em: Include getopt.h earlier.
	* emultempl/ticoff.em: Likewise.

2003-02-28  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/elf32.em (gld${EMULATION_NAME}_get_script): Add combreloc
	support when scripts read from files.

2003-02-28  Alan Modra  <amodra@bigpond.net.au>

	* ldemul.c (ldemul_parse_args): Return FALSE by default.
	* ldemul.h (struct ld_emulation_xfer_struct): Update parse_args
	comment.

	* ldemul.c (ldemul_add_options, ldemul_handle_option): New functions.
	(ldemul_parse_args): Return bfd_boolean.  Formatting.
	* ldemul.h (ldemul_add_options, ldemul_handle_option): Declare.
	(ldemul_parse_args): Adjust.
	(struct ld_emulation_xfer_struct): Add add_options and handle_option.
	Return bfd_boolean from parse_args.
	* lexsup.c (parse_args): Malloc shortopts, longopts and
	really_longopts.  Call ldemul_add_options and ldemul_handle_option.
	* emultempl/aix.em (gld${EMULATION_NAME}_add_options): Split out from
	gld${EMULATION_NAME}_parse_args.
	(gld${EMULATION_NAME}_handle_option): Likewise.
	(ld_${EMULATION_NAME}_emulation): Adjust initializer.
	* emultempl/armcoff.em: As for aix.em, but remove parse_args.
	* emultempl/beos.em: Likewise.
	* emultempl/pe.em: Likewise.
	* emultempl/ticoff.em: Likewise.
	* emultempl/elf32.em: Likewise.  Don't duplicate long options either.
	(gld${EMULATION_NAME}_add_sysroot): Prototype.
	* emultempl/armelf.em (PARSE_AND_LIST_LONGOPTS): Don't duplicate
	options.
	* emultempl/hppaelf.em (PARSE_AND_LIST_LONGOPTS): Likewise.
	* emultempl/ppc32elf.em (PARSE_AND_LIST_LONGOPTS): Likewise.
	* emultempl/ppc64elf.em (PARSE_AND_LIST_LONGOPTS): Likewise.
	* emultempl/armelf_oabi.em (ld_${EMULATION_NAME}_emulation): Adjust
	initializer.
	* emultempl/generic.em: Likewise.
	* emultempl/gld960.em: Likewise.
	* emultempl/gld960c.em: Likewise.
	* emultempl/linux.em: Likewise.
	* emultempl/lnk960.em: Likewise.
	* emultempl/m68kcoff.em: Likewise.
	* emultempl/mipsecoff.em: Likewise.
	* emultempl/sunos.em: Likewise.
	* emultempl/vanilla.em: Likewise.
	* emultempl/netbsd.em (gldnetbsd_before_parse): Prototype.

2003-02-25  Alexandre Oliva  <aoliva@redhat.com>

	* emultempl/elf32.em (gld${EMULATION_NAME}_add_sysroot): Fix
	memory allocation error.

	* Makefile.am (ldmain.o): Define TOOLBINDIR.
	* Makefile.in: Rebuilt.
	* ldmain.c (ld_sysroot): Try to set from TOOLBINDIR too.

2003-02-21  Bob Wilson  <bob.wilson@acm.org>

	* ldlang.c (lang_size_sections_1): Add CHECK_REGIONS argument and only
	call os_region_check when it is set.
	(lang_size_sections): Add CHECK_REGIONS argument and pass it through to
	lang_size_sections_1.
	(lang_process): Change lang_size_sections calls to set CHECK_REGIONS
	only for the last call, not on every relaxation iteration.
	* ldlang.h (lang_size_sections): Update prototype.
	* pe-dll.c (pe_dll_fill_sections): Set CHECK_REGIONS argument in calls
	to lang_size_sections.
	(pe_exe_fill_sections): Likewise.
	* emultempl/elf32.em (gld${EMULATION_NAME}_finish): Likewise.
	* emultempl/hppaelf.em (hppaelf_layout_sections_again): Likewise.
	* emultempl/ppc64elf.em (ppc_before_allocation): Likewise.
	(ppc_layout_sections_again): Likewise.

2003-02-21  Bob Wilson  <bob.wilson@acm.org>

	* gen-doc.texi: Set ARM and HPPA variables.
	* ld.texinfo: Fix typos and obvious texinfo mistakes.  Make section
	title capitalization more consistent.  Add missing menu entries for
	machine-specific sections and conditionalize them consistently.
	Conditionalize text that is irrelevant when SingleFormat is set.
	Add @group divisions to improve page breaks in long examples.
	Use @iftex/@ifnottex instead of @iftex/@ifinfo so that HTML output
	is correct.  Remove "FIXME" comment about not using
	@raisesections/@lowersections.  Use @raisesections/@lowersections
	consistently for machine-specific sections.  Change to be more polite
	about poor bug reports.  Replace FDL appendix with include of fdl.texi.
	Move WIN32 node to match its order in the menus.
	* fdl.texi: New file.

2003-02-20  Alexandre Oliva  <aoliva@redhat.com>

	* configure.in (TARGET_SYSTEM_ROOT): Set default to
	${exec_prefix}/${target_alias}/sys-root.  Match explicit
	'${exec_prefix}' (in addition to the expansion thereof) as
	relocatable.
	* configure: Rebuilt.

2003-02-20  Phil Edwards  <pme@gcc.gnu.org>

	* ldgram.y (vers_defns): Also recurse with 'EXTERN NAME' patterns.

2003-02-20  Harri Porten  <porten@kde.org>

	* ldgram.y (vers_defns): Allow optional trailing semicolon in
	EXTERN NAME block;

2003-02-18  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc32elf.em: New file.
	* emulparams/elf32ppc.sh (EXTRA_EM_FILE): Define.
	* Makefile.am (eelf32lppc.c): Depend on emultempl/ppc32elf.em.
	(eelf32lppcnto.c): Likewise.
	(eelf32lppcsim.c): Likewise.
	(eelf32ppcnto.c): Likewise.
	(eelf32ppc.c): Likewise.
	(eelf32ppc_fbsd.c): Likewise.
	(eelf32ppcsim.c): Likewise.
	(eelf32ppclinux.c): Likewise.
	* Makefile.in: Regenerate.

2003-02-18  Alan Modra  <amodra@bigpond.net.au>

	* ld.texinfo: Remove spaces between @samp and opening brace.

2003-02-18  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em (ppc_create_output_section_statements): Check
	hash creator.
	(ppc_before_allocation): Don't do optimizations if wrong hash table.
	(gld${EMULATION_NAME}_finish): Ditto.

2003-02-17  Nick Clifton  <nickc@redhat.com>

	* ldmain.c (main) Default allow_shlib_undefined to true.
	* lexsup.c (ld_options): Add --no-allow-shlib-undefined.
	(parse_args): Parse the new switch.
	* ld.texinfo: Document new switch and default behaviour of
	allowing undefined symbols in shared libraries.

2003-02-11 Dmitry Diky  <diwil@mail.ru>

	* scripttempl/elf32msp430.sc: Add new data anchors definitions.
	* scripttempl/elf32msp430_3.sc: Likewise.

2003-02-11  Uwe Stieber  <uwe@wwws.de>

	* configure.tgt: Add support for kaOS as cross build target
	system.

2003-02-10  John Daivid Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* hppaelf.em (group_size): Change default back to 1.

2003-02-09  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em: Add "no-tls-optimize" option and support code.

2003-02-07  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>

	* hppaelf.em (group_size): Change default to -1.

2003-02-07  Nick Clifton  <nickc@redhat.com>

	* emultempl/armelf.em (PARSE_AND_LIST_SHORTOPTS): Remove 'n' short
	opt.
	(PARSE_AND_LIST_LONGOPTS): Add duplicate entry for
	no-pipeline-knowledge.  This will prevent the getopt package from
	thinking that there are any shorter abbreviations for
	--no-pipeline-knowledge.

2003-02-07  Jakub Jelinek  <jakub@redhat.com>

	* genscripts.sh (LIB_PATH): Don't append LIBPATH_SUFFIX to paths
	which already have it.  Avoid duplicates.

2003-02-06  Jakub Jelinek  <jakub@redhat.com>

	* emulparams/elf64_s390.sh (LIBPATH_SUFFIX): Set to 64.
	* emulparams/elf_x86_64.sh (LIBPATH_SUFFIX): Likewise.
	* emulparams/elf64_sparc.sh (LIBPATH_SUFFIX): Set instead of suffix.

2003-02-05  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/ppc64elf.em (ppc_before_allocation): Size sections then
	call ppc64_elf_tls_optimize.

2003-02-03  Daniel Jacobowitz  <drow@mvista.com>

	* emultempl/elf32.em: Move gld${EMULATION_NAME}_add_sysroot
	outside of GNU/Linux conditional.

2003-01-28  Ralf Habacker  <ralf.habacker@freenet.de>

	* deffilep.y (def_get_module): New function: locate an already
	added module.
	* deffile.h (def_get_module): New prototype.
	* pe-dll.c (pe_implied_import_dll): Add code to prevent importing
	a dll multiple times.

2003-01-23  Alan Modra  <amodra@bigpond.net.au>

	* emultempl/sh64elf.em: Include elf32-sh64.h.
	(sh64_elf_${EMULATION_NAME}_before_allocation): Adjust for changed
	sh64_elf_section_data.
	(sh64_elf_${EMULATION_NAME}_after_allocation): Likewise.

2003-01-23  Wu Yongwei  <adah@netstd.com>

	* ld.texinfo: Remove an extra "i" in --dll-search-prefix.
	* emultempl/pe.em (gld_${EMULATION_NAME}_list_options): Move a
	cross-80th-column-margin "an" to the next line.

2003-01-21  Nick Clifton  <nickc@redhat.com>

	* emulparams/tic3xcoff-onchip.sh: Rename to ...z
	* emulparams/tic3xcoff_onchip.sh: ...this.
	* Makefile.am (etic3xcoff_onchip.c): Fix name of generated C file.
	* Makefile.in: Regenerate.

2003-01-21  Fabio Alemagna  <falemagn@aros.org>

	* configure.tgt: Handle i[3456]86-*-aros*

2003-01-19  Svein E. Seldal  <Svein.Seldal@solidas.com>

	* Makefile.am: Added etic3xcoff.o and etic4xcoff_onchip.o
	* Makefile.in: Regenerate
	* configure.tgt: Added extra target emulations
	* emulparams/tic3xcoff.sh: Remove old settings
	* emulparams/tic4xcoff.sh: Ditto
	* emulparams/tic3xcoff-onchip.sh: Added new
	* scripttempl/tic4xcoff.sc: Revise and combine both c3x and c4x
	* scripttempl/tic3xcoff.sc: Remove

2003-01-17  Andreas Jaeger  <aj@suse.de>

	* emultempl/elf32.em (gld${EMULATION_NAME}_add_sysroot): Do not
	skip ':'.

2003-01-16  Alan Modra  <amodra@bigpond.net.au>

	* Makefile.in: Regenerate.

2002-01-14  Charles Wilson  <cwilson@ece.gatech.edu>

	* ld.texinfo (node WIN32): Some clarifications
	and formatting fixups.

2003-01-09  Chris Demetriou  <cgd@broadcom.com>

	* ldmain.c (get_emulation): Sort -mipsNN checks in the usual
	order, and handle (ignore) -mips32r2.

2003-01-09  Daniel Jacobowitz  <drow@mvista.com>

	* ldmain.c (main): Make sure ld_sysroot is initialized.

2003-01-06  Daniel Jacobowitz  <drow@mvista.com>

	* Makefile.am (eelf32iq10.c): Fix tab/whitespace mixup.

	* Makefile.am (ldmain.o): Add @TARGET_SYSTEM_ROOT_DEFINE@.
	(GENSCRIPTS): Add @use_sysroot@.
	* Makefile.in: Regenerated.
	* configure.host: Move setting of NATIVE_LIB_DIRS to...
	* configure.tgt: ... here.  Use ${target} instead of ${host}
	for NATIVE_LIB_DIRS.
	* configure.in: Add --with-sysroot.
	* configure: Regenerated.
	* genscripts.sh: Accept use_sysroot option.  Set new variables
	NATIVE and USE_LIBPATH.  Prepend "=" to directory names if
	$use_sysroot.  Don't search $tool_lib if $use_sysroot.
	* ldfile.c (ldfile_add_library_path): Handle leading '='.
	* ldmain.c (TARGET_SYSTEM_ROOT): Define if not defined.
	(ld_sysroot): New variable.
	(main): Initialize ld_sysroot.
	* ldmain.h (ld_sysroot): New extern.
	* emultempl/elf32.em: Use NATIVE and USE_LIBPATH instead of
	searching $EMULATION_LIBPATH.
	(gld${EMULATION_NAME}_add_sysroot): New function.
	(gld${EMULATION_NAME}_check_ld_so_conf): Use it.  Honor ld_sysroot.
	(gld${EMULATION_NAME}_after_open): Likewise.  Only search
	environment variables if $NATIVE.
	* ld.texinfo (Options): Mention "=" prefix in the description of -L.
	* NEWS: Mention --with-sysroot.

	* emulparams/elf32bmipn32-defs.sh: Set NATIVE and LIBPATH_SUFFIX
	instead of setting LIB_PATH.
	* emulparams/elf32ppc.sh: Likewise.
	* emulparams/elf64_s390.sh: Likewise.
	* emulparams/elf64_sparc.sh: Likewise.
	* emulparams/elf64ppc.sh: Likewise.
	* emulparams/elf_x86_64.sh: Likewise.

	* emulparams/elf64_aix.sh: Add "=" prefixes to LIB_PATH.
	* emulparams/elf64hppa.sh: Add "=" prefixes to LIB_PATH.

2003-01-03  Charles Wilson  <cwilson@ece.gatech.edu>

	* pe-dll.c (autofilter_symbollist): Add cygwin_crt0.

2003-01-04  Daniel Jacobowitz  <drow@mvista.com>

	* Makefile.am (ldmain.o): Pass BINDIR.
	* Makefile.in: Regenerated.
	* ldmain.c (set_scripts_dir): Use make_relative_prefix for the first
	search path.

2003-01-02  Ben Elliston  <bje@redhat.com>

	* Makefile.am (ALL_EMULATIONS): Add eelf32iq2000.o.
	(eelf32iq2000.c): New target.
	* Makefile.in: Regenerate.
	* configure.tgt: Handle iq2000-*-elf.
	* emulparams/elf32iq10.sh: New file.
	* emulparams/elf32iq2000.sh: New file.
	* scripttempl/iq2000.sc: New file.

2003-01-02 Charles Wilson <cwilson@ece.gatech.edu>

	* pe-dll.c (autofilter_symbollist): Add do_pseudo_reloc
	and _pei386_runtime_relocator to the exclude list.

2003-01-01  Kazu Hirata  <kazu@cs.umass.edu>

	* ldfile.c: Fix comment typos.
	* ldlang.c: Likewise.
	* mri.c: Likewise.
	* pe-dll.c: Likewise.

2003-01-01  Daniel Jacobowitz  <drow@mvista.com>

	Suggested by Manfred Hollstein <manfred.h@gmx.net>:
	* Makefile.am (ld.1): Depend on configdoc.texi
	and ldver.texi.
	* Makefile.in: Regenerated.

For older changes see ChangeLog-0001

Local Variables:
mode: change-log
left-margin: 8
fill-column: 74
version-control: never
End:
